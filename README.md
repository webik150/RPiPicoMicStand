# RPiPicoMicStand

NOTE: This is VERY WIP, mostly in idea phase.

I don't have a better name rn, subject to change (suggestions welcome).

This project aims to create a motorized microphone stand using old NEMA-17 stepper motors from Prusa MK3, controllable through a LAN web server hosted on a RPi Pico W using MicroPython. The hardware part rn works on a breadboard, once I design some PCB it'll also be stored here. 

The software part (not implemented yet) operates in two modes:

- **Pairing Mode**: When no Wi-Fi credentials are available at startup, the device creates a Wi-Fi Access Point (AP) and serves as a captive portal to allow users to configure the Wi-Fi settings.
- **Work Mode**: Once Wi-Fi credentials are saved, the device connects to the saved network and serves a control website on the local network.

## HW Features
- Movement on X and Y axes (Forward/Back and Left/Right)
- Mic rotation on one axis
- Powered by 12V, idk how many A will be needed yet.
- I'll try to make as much of the actual structure 3D printable

## SW Features
1. **Pairing Mode**:
   - Automatically activates if no Wi-Fi credentials are saved or (hopefully) by holding the BOOTSEL button for 10s after bootup.
   - Creates an AP with a preset SSID and password.
   - Acts as a captive portal for users to select which Wi-Fi network to join.
   - Scans for available networks and allows the user to select one and input the password.

2. **Work Mode**:
   - After successful Wi-Fi configuration, the device connects to the network.
   - Serves a local web page with controls to interact with the microphone stand.
   - Technically this should also allow you to calibrate the stand and such (or maybe it should autocalibrate at start, but I feel like that might be dangerous if you just plug it in randomly by a mistake or whatever), but I'll see if I manage to figure out how Prusa auto-home works for XY axes.

Alternativelly, the pairing mode could also have the controls directly, which would allow you to use the stand even without functional wifi (ig somewhere outside or at a venue).

## Requirements

- **Hardware**:
  - TODO

- **Software**:
  - MicroPython installed on the Pico W
  - Thonny IDE (or any other Python IDE capable of uploading MicroPython scripts to the Pico W)
  - MicroPython modules:
    - `network` for Wi-Fi functionality
    - `socket` for HTTP server implementation
    - `ujson` for saving/loading Wi-Fi credentials

## Installation & Setup
idk if this is correct, ChatGPT came up with these instructions and I haven't had time to check them yet lol.

1. **Flash MicroPython on Raspberry Pi Pico W**:
    - Download the MicroPython firmware for Pico W from [here](https://micropython.org/download/rp2-pico-w/).
    - Flash the firmware to your Pico W using the Thonny IDE or another method.

2. **Clone the Repository**:
    ```bash
    git clone https://github.com/yourusername/rpi-pico-w-lan-server.git
    cd rpi-pico-w-lan-server
    ```

3. **Upload Files to Pico W**:
    - Use Thonny or another IDE to upload the required Python files to your Pico W. The key files include:
        - `main.py`: The main logic for the pairing mode, Wi-Fi connection, and work mode.
        - `wifi_config.json`: (Optional) Pre-existing Wi-Fi credentials file. This will be automatically generated by the device when the user sets up Wi-Fi through the captive portal.

4. **Modify the Configuration**:
    - If you want to set a custom SSID and password for the access point, edit the following lines in `main.py`:
      ```python
      ap.config(essid='RPi_Pico_Setup', password='12345678')
      ```

5. **Running the Project**:
    - Plug in the Raspberry Pi Pico W, and the script will automatically run.
    - If the device is unable to connect to a Wi-Fi network, it will enter **Pairing Mode**, where you can connect to the access point `RPi_Pico_Setup` and configure the network settings.
    - Once the Wi-Fi credentials are applied, the Pico W will switch to **Work Mode** and serve the control webpage on the local network.

## Usage

### Pairing Mode

1. Connect to the Wi-Fi access point `RPi_Pico_Setup` with the password `12345678`.
2. Your device (phone or computer) should automatically open a captive portal page.
3. Select a network from the dropdown and enter the Wi-Fi password.
4. Press "Apply" to save the credentials and switch to work mode.

### Work Mode

1. The Pico W connects to the saved Wi-Fi network and launches a web server on port `80`.
2. Access the control page by navigating to the Pico's IP address in a web browser (use `wlan.ifconfig()` to find the IP).
3. Use the sliders, buttons, and other controls on the page to interact with the Pico's GPIO pins or perform other tasks.

## Example Screenshots

**Pairing Mode Captive Portal**:

![Captive Portal](./images/captive_portal_example.png)

**Work Mode Control Webpage**:

![Work Mode Control Page](./images/work_mode_example.png)

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

